<!-- propertie-form/propertie-form.component.html -->
<h2 mat-dialog-title>{{ _entity ? 'Modifier' : 'Créer' }} une propriété</h2>

<mat-dialog-content>

    
            <form class="compact" [formGroup]="basicForm">
                <div class="flex flex-wrap">
                    <div class="w-full">
                        @for (item of fields;track item._id) {
                            <!---->
                            @if (isVisible(item.visibleClause)) {
                                @if (item.type == "1") {
                                    <div class="!pb-4">
                                        <mat-form-field class="full-width">
                                            <input
                                                matInput
                                                name={{item._id}}
                                                [(ngModel)]="item.model[item._id]" 
                                                formControlName={{item._id}}
                                                placeholder={{item.placeholder}}
                                                value="">
                                        </mat-form-field>
                                        <small 
                                        *ngIf="basicForm.controls[item._id].hasError('minlength') && basicForm.controls[item._id].touched" 
                                        class="form-error-msg"> Title require at least {{basicForm.controls[item._id].errors.minlength.requiredLength}} characters </small>
                                        <small 
                                        *ngIf="basicForm.controls[item._id].hasError('maxlength') && basicForm.controls[item._id].touched" 
                                        class="form-error-msg"> Title can not contain more than {{basicForm.controls[item._id].errors.maxlength.requiredLength}} characters </small>
                                    </div>
                                }
                                <!---->
                                @if (item.type == "2") { 
                                    <div class="!pb-4">
                                        <mat-form-field class="full-width">
                                            <textarea
                                            matInput 
                                            [(ngModel)]="item.model[item._id]" 
                                            name={{item._id}} 
                                            formControlName={{item._id}} 
                                            placeholder={{item.placeholder}}
                                            value="">
                                        </textarea>
                                        </mat-form-field>
                                        <small 
                                        *ngIf="basicForm.controls[item._id].hasError('required') && basicForm.controls[item._id].touched" 
                                        class="form-error-msg"> Description is required </small>
                                    </div>
                                }
                                <!---->
                                @if (item.type == "3") { 
                                    <div class="!pb-4">
                                        <mat-form-field class="full-width">
                                            <mat-label>Select an option</mat-label>
                                            <mat-select [(value)]="item.model[item._id]" [(ngModel)]="item.model[item._id]" name={{item._id}} 
                                                formControlName={{item._id}} >
                                                <mat-option>None</mat-option>
                                                @for (item of item.datasource; track item.code) {
                                                    <mat-option value="{{item.code}}">{{item.name}}</mat-option>
                                                }
                                            </mat-select>
                                        </mat-form-field>
                                        <small *ngIf="basicForm.controls[item._id].hasError('required') && basicForm.controls[item._id].touched" 
                                            class="form-error-msg"> Description is required </small>
                                    </div>
                                }
                                @if (item.type == "4") { 
                                    <div class="!pb-4">
                                    <!--[(ngModel)]="isTopbarFixed" (change)="toggleTopbarFixed($event)" [disabled]="selectedLayout === 'top'" [value]="selectedLayout !== 'top'"-->
                                        <mat-checkbox   [(ngModel)]="item.model[item._id]" 
                                                name={{item._id}} formControlName={{item._id}} >{{item.placeholder}}</mat-checkbox>
                                    </div>
                                }
                            }
                            
                        }

                        

                        <mat-divider></mat-divider>   
                        
                    </div>
                </div>
                
            </form>
        
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()">Annuler</button>
  <button mat-flat-button color="primary" (click)="submit()" [disabled]="basicForm.invalid">
    Enregistrer
  </button>
</mat-dialog-actions>